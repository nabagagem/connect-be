package com.nabagagem.connectbe.controllers;

import lombok.AllArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.security.oauth2.jwt.Jwt;
import org.springframework.security.oauth2.jwt.JwtDecoder;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestHeader;
import org.springframework.web.bind.annotation.RestController;

@Slf4j
@RestController
@AllArgsConstructor
public class TestToken {
    private final JwtDecoder jwtDecoder;

    @GetMapping("/test")
    public Test get(@RequestHeader(name = "Authorization", required = false) String token) {
        log.info(token);
        /*
        Your token is eyJraWQiOiJXeWZlcUgrT1F1ck9XRGV4NUdXcXB1V2phRFJwRFNSbWNrMWMyeUszeVZ3PSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiI0MmIyM2RiZi1kYWYyLTRkODYtYTk3My0wZmZmNGY2NmNlMGQiLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAudXMtZWFzdC0xLmFtYXpvbmF3cy5jb21cL3VzLWVhc3QtMV9HQ1M0S1V3VnciLCJ2ZXJzaW9uIjoyLCJjbGllbnRfaWQiOiI1YnRydHJtNDl0ZTEwZTYxOWx0Zmt1bWVwNyIsIm9yaWdpbl9qdGkiOiIxYWI0ZWM0OS01MTBlLTRjNWYtODY5My1iOWQxODE4MDVjZTgiLCJldmVudF9pZCI6IjExYzU2NzkzLTg1YTMtNGM1YS1hY2VjLTNmN2JkYmVmNDgxMCIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoicGhvbmUgb3BlbmlkIGVtYWlsIiwiYXV0aF90aW1lIjoxNzA5NTQ1ODQxLCJleHAiOjE3MDk1NTE4NDEsImlhdCI6MTcwOTU0NTg0MSwianRpIjoiOWU5NDNjZmMtODVhMS00ZGQyLWIzNzEtODcxN2QwZmVmMWRmIiwidXNlcm5hbWUiOiJiYXVtYW5uX3IifQ.l2jvX-XbE3BYb3GFBnywVwzzlvz8yMDj6xV0ncpzj05-SVIr0X0m4L464K4J4exgFno6uRldEMdzlWgmEoEUKWWegfJQX2WFyfG1cQhqVgQgFP0HPF-dNbkUKmr0hSnlVaz1zKkPoDuCcX5jsOBaVyJei_Pvaf_JlRgCxldNug6aAajubj1FcFiyyJG4YPEnD1PHq1ndU6Sf9v90HAVz45g4-CRM4KB20P8zfLHWnO2WV7WQxHIVNg4JWb6gxUxNCkLjfP7qyJUmC9Ui4-Bb6l34DF6IYDjbUad9vK7M8siMRchKK2dn6_BPp7F3_05Fb8vRRfo2ddZHuWqjxioOnQ
         */
        String tokenTest = "eyJraWQiOiJXeWZlcUgrT1F1ck9XRGV4NUdXcXB1V2phRFJwRFNSbWNrMWMyeUszeVZ3PSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiI0MmIyM2RiZi1kYWYyLTRkODYtYTk3My0wZmZmNGY2NmNlMGQiLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAudXMtZWFzdC0xLmFtYXpvbmF3cy5jb21cL3VzLWVhc3QtMV9HQ1M0S1V3VnciLCJ2ZXJzaW9uIjoyLCJjbGllbnRfaWQiOiI1YnRydHJtNDl0ZTEwZTYxOWx0Zmt1bWVwNyIsIm9yaWdpbl9qdGkiOiIxYWI0ZWM0OS01MTBlLTRjNWYtODY5My1iOWQxODE4MDVjZTgiLCJldmVudF9pZCI6IjExYzU2NzkzLTg1YTMtNGM1YS1hY2VjLTNmN2JkYmVmNDgxMCIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoicGhvbmUgb3BlbmlkIGVtYWlsIiwiYXV0aF90aW1lIjoxNzA5NTQ1ODQxLCJleHAiOjE3MDk1NTE4NDEsImlhdCI6MTcwOTU0NTg0MSwianRpIjoiOWU5NDNjZmMtODVhMS00ZGQyLWIzNzEtODcxN2QwZmVmMWRmIiwidXNlcm5hbWUiOiJiYXVtYW5uX3IifQ.l2jvX-XbE3BYb3GFBnywVwzzlvz8yMDj6xV0ncpzj05-SVIr0X0m4L464K4J4exgFno6uRldEMdzlWgmEoEUKWWegfJQX2WFyfG1cQhqVgQgFP0HPF-dNbkUKmr0hSnlVaz1zKkPoDuCcX5jsOBaVyJei_Pvaf_JlRgCxldNug6aAajubj1FcFiyyJG4YPEnD1PHq1ndU6Sf9v90HAVz45g4-CRM4KB20P8zfLHWnO2WV7WQxHIVNg4JWb6gxUxNCkLjfP7qyJUmC9Ui4-Bb6l34DF6IYDjbUad9vK7M8siMRchKK2dn6_BPp7F3_05Fb8vRRfo2ddZHuWqjxioOnQ";
        Jwt jwt = jwtDecoder.decode(tokenTest);
        /*

         */
        return new Test(jwt.getClaims());
    }

    public void run(String... args) throws Exception {
        /*
        Your token is eyJraWQiOiJXeWZlcUgrT1F1ck9XRGV4NUdXcXB1V2phRFJwRFNSbWNrMWMyeUszeVZ3PSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiI0MmIyM2RiZi1kYWYyLTRkODYtYTk3My0wZmZmNGY2NmNlMGQiLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAudXMtZWFzdC0xLmFtYXpvbmF3cy5jb21cL3VzLWVhc3QtMV9HQ1M0S1V3VnciLCJ2ZXJzaW9uIjoyLCJjbGllbnRfaWQiOiI1YnRydHJtNDl0ZTEwZTYxOWx0Zmt1bWVwNyIsIm9yaWdpbl9qdGkiOiIxYWI0ZWM0OS01MTBlLTRjNWYtODY5My1iOWQxODE4MDVjZTgiLCJldmVudF9pZCI6IjExYzU2NzkzLTg1YTMtNGM1YS1hY2VjLTNmN2JkYmVmNDgxMCIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoicGhvbmUgb3BlbmlkIGVtYWlsIiwiYXV0aF90aW1lIjoxNzA5NTQ1ODQxLCJleHAiOjE3MDk1NTE4NDEsImlhdCI6MTcwOTU0NTg0MSwianRpIjoiOWU5NDNjZmMtODVhMS00ZGQyLWIzNzEtODcxN2QwZmVmMWRmIiwidXNlcm5hbWUiOiJiYXVtYW5uX3IifQ.l2jvX-XbE3BYb3GFBnywVwzzlvz8yMDj6xV0ncpzj05-SVIr0X0m4L464K4J4exgFno6uRldEMdzlWgmEoEUKWWegfJQX2WFyfG1cQhqVgQgFP0HPF-dNbkUKmr0hSnlVaz1zKkPoDuCcX5jsOBaVyJei_Pvaf_JlRgCxldNug6aAajubj1FcFiyyJG4YPEnD1PHq1ndU6Sf9v90HAVz45g4-CRM4KB20P8zfLHWnO2WV7WQxHIVNg4JWb6gxUxNCkLjfP7qyJUmC9Ui4-Bb6l34DF6IYDjbUad9vK7M8siMRchKK2dn6_BPp7F3_05Fb8vRRfo2ddZHuWqjxioOnQ
         */
        String tokenTest = "eyJraWQiOiJXeWZlcUgrT1F1ck9XRGV4NUdXcXB1V2phRFJwRFNSbWNrMWMyeUszeVZ3PSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiI0MmIyM2RiZi1kYWYyLTRkODYtYTk3My0wZmZmNGY2NmNlMGQiLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAudXMtZWFzdC0xLmFtYXpvbmF3cy5jb21cL3VzLWVhc3QtMV9HQ1M0S1V3VnciLCJ2ZXJzaW9uIjoyLCJjbGllbnRfaWQiOiI1YnRydHJtNDl0ZTEwZTYxOWx0Zmt1bWVwNyIsIm9yaWdpbl9qdGkiOiIxYWI0ZWM0OS01MTBlLTRjNWYtODY5My1iOWQxODE4MDVjZTgiLCJldmVudF9pZCI6IjExYzU2NzkzLTg1YTMtNGM1YS1hY2VjLTNmN2JkYmVmNDgxMCIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoicGhvbmUgb3BlbmlkIGVtYWlsIiwiYXV0aF90aW1lIjoxNzA5NTQ1ODQxLCJleHAiOjE3MDk1NTE4NDEsImlhdCI6MTcwOTU0NTg0MSwianRpIjoiOWU5NDNjZmMtODVhMS00ZGQyLWIzNzEtODcxN2QwZmVmMWRmIiwidXNlcm5hbWUiOiJiYXVtYW5uX3IifQ.l2jvX-XbE3BYb3GFBnywVwzzlvz8yMDj6xV0ncpzj05-SVIr0X0m4L464K4J4exgFno6uRldEMdzlWgmEoEUKWWegfJQX2WFyfG1cQhqVgQgFP0HPF-dNbkUKmr0hSnlVaz1zKkPoDuCcX5jsOBaVyJei_Pvaf_JlRgCxldNug6aAajubj1FcFiyyJG4YPEnD1PHq1ndU6Sf9v90HAVz45g4-CRM4KB20P8zfLHWnO2WV7WQxHIVNg4JWb6gxUxNCkLjfP7qyJUmC9Ui4-Bb6l34DF6IYDjbUad9vK7M8siMRchKK2dn6_BPp7F3_05Fb8vRRfo2ddZHuWqjxioOnQ";
        Jwt jwt = jwtDecoder.decode(tokenTest);
        log.info("decoded: {}", jwt.getClaims());
        /*

         */
    }

    private record Test(
            java.util.Map<String, Object> name
    ) {
    }
}
